{% extends 'finances/base.html' %}

{% block title %}–î–∞—à–±–æ—Ä–¥ - –õ–∏—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">üìä –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-success stat-card">
                <div class="card-body">
                    <h5 class="card-title">–î–æ—Ö–æ–¥—ã</h5>
                    <p class="card-text display-6">{{ income|floatformat:2 }} ‚ÇΩ</p>
                    <small>–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: {{ total_operations }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-danger stat-card">
                <div class="card-body">
                    <h5 class="card-title">–†–∞—Å—Ö–æ–¥—ã</h5>
                    <p class="card-text display-6">{{ expense|floatformat:2 }} ‚ÇΩ</p>
                    <small>–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π: {{ total_operations }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card text-white bg-info stat-card">
                <div class="card-body">
                    <h5 class="card-title">–ë–∞–ª–∞–Ω—Å</h5>
                    <p class="card-text display-6">{{ balance|floatformat:2 }} ‚ÇΩ</p>
                    {% if balance > 0 %}
                        <small>‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π</small>
                    {% elif balance < 0 %}
                        <small>‚ö†Ô∏è –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π</small>
                    {% else %}
                        <small>‚ûñ –ù—É–ª–µ–≤–æ–π</small>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h5>
                </div>
                <div class="card-body">
                    {% if recent_operations %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for op in recent_operations %}
                                        <tr>
                                            <td>{{ op.date }}</td>
                                            <td>
                                                <span class="badge {% if op.category == '–¥–æ—Ö–æ–¥' %}bg-success{% else %}bg-danger{% endif %}">
                                                    {{ op.category }}
                                                </span>
                                            </td>
                                            <td class="{% if op.category == '–¥–æ—Ö–æ–¥' %}income{% else %}expense{% endif %}">
                                                <strong>{{ op.amount|floatformat:2 }} ‚ÇΩ</strong>
                                            </td>
                                            <td>{{ op.description|truncatechars:30 }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <a href="{% url 'operation_list' %}" class="btn btn-outline-primary">
                            –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Üí
                        </a>
                    {% else %}
                        <p class="text-muted mb-0">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π. 
                            <a href="{% url 'add_operation' %}">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é!</a>
                        </p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
