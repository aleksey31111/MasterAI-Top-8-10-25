{% extends 'finances/base.html' %}

{% block title %}–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>üìã –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h1>
        <a href="{% url 'add_operation' %}" class="btn btn-success">
            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
        </a>
    </div>
    
    <!-- –ö—Ä–∞—Ç–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card border-success">
                <div class="card-body">
                    <h5 class="card-title text-success">–î–æ—Ö–æ–¥—ã</h5>
                    <p class="card-text h4">{{ total_income|floatformat:2 }} ‚ÇΩ</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-danger">
                <div class="card-body">
                    <h5 class="card-title text-danger">–†–∞—Å—Ö–æ–¥—ã</h5>
                    <p class="card-text h4">{{ total_expense|floatformat:2 }} ‚ÇΩ</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-info">
                <div class="card-body">
                    <h5 class="card-title text-info">–ë–∞–ª–∞–Ω—Å</h5>
                    <p class="card-text h4">{{ balance|floatformat:2 }} ‚ÇΩ</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–π -->
    {% if operations %}
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for op in operations %}
                                <tr>
                                    <td>{{ op.id }}</td>
                                    <td>{{ op.date }}</td>
                                    <td>
                                        <span class="badge {% if op.category == '–¥–æ—Ö–æ–¥' %}bg-success{% else %}bg-danger{% endif %}">
                                            {{ op.category }}
                                        </span>
                                    </td>
                                    <td class="{% if op.category == '–¥–æ—Ö–æ–¥' %}income{% else %}expense{% endif %} fw-bold">
                                        {{ op.amount|floatformat:2 }} ‚ÇΩ
                                    </td>
                                    <td>{{ op.description }}</td>
                                    <td>
                                        <form method="post" 
                                              action="{% url 'delete_operation' op.id %}" 
                                              style="display: inline;">
                                            {% csrf_token %}
                                            <button type="submit" 
                                                    class="btn btn-sm btn-danger" 
                                                    onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é?')">
                                                üóëÔ∏è
                                            </button>
                                        </form>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% else %}
        <div class="alert alert-info">
            <h5 class="alert-heading">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π!</h5>
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏. 
               <a href="{% url 'add_operation' %}" class="alert-link">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é</a>.</p>
        </div>
    {% endif %}
</div>
{% endblock %}
